{
  "name": "AI Viral Video Creator (Claude + Veo 3) - BASIT",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [240, 400],
      "id": "manual-trigger",
      "name": "â–¶ï¸ Manuel BaÅŸlat"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "topic",
              "name": "topic",
              "type": "string",
              "value": "Renkli sabun kesme ASMR videosu"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.3,
      "position": [460, 400],
      "id": "set-topic",
      "name": "ğŸ“ Video Konusu"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.anthropic.com/v1/messages",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "anthropicApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "x-api-key",
              "value": "={{$env.ANTHROPIC_API_KEY}}"
            },
            {
              "name": "anthropic-version",
              "value": "2023-06-01"
            },
            {
              "name": "content-type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"claude-sonnet-4-20250514\",\n  \"max_tokens\": 2048,\n  \"temperature\": 0.7,\n  \"system\": \"Sen viral video fikirleri Ã¼reten bir AI'sÄ±n. KullanÄ±cÄ±nÄ±n verdiÄŸi konuya gÃ¶re TEK BÄ°R viral video fikri Ã¼ret.\\n\\n**Kurallar:**\\n1. Sadece 1 fikir Ã¼ret\\n2. Fikir: Maksimum 13 kelime, viral ve ilgi Ã§ekici\\n3. Caption: KÄ±sa, Ã§arpÄ±cÄ±, 1 emoji ve tam 12 hashtag\\n4. Environment: Maksimum 20 kelime, gÃ¶rsel ortam tanÄ±mÄ±\\n5. Sound: Maksimum 15 kelime, ses/mÃ¼zik tanÄ±mÄ±\\n6. Duration: Video sÃ¼resi Ã¶nerisi (15-60 saniye)\\n7. Style: GÃ¶rsel stil (cinematic, ASMR, satisfying, vb)\\n\\n**SADECE bu JSON formatÄ±nÄ± dÃ¶ndÃ¼r, baÅŸka hiÃ§bir ÅŸey yazma:**\\n{\\n  \\\"idea\\\": \\\"13 kelimelik fikir\\\",\\n  \\\"caption\\\": \\\"caption emoji ile\\\",\\n  \\\"hashtags\\\": [\\\"viral\\\", \\\"asmr\\\", \\\"satisfying\\\", \\\"trending\\\", \\\"fyp\\\", \\\"kesfet\\\", \\\"video\\\", \\\"short\\\", \\\"reels\\\", \\\"tiktok\\\", \\\"youtube\\\", \\\"instagram\\\"],\\n  \\\"environment\\\": \\\"gÃ¶rsel ortam maksimum 20 kelime\\\",\\n  \\\"sound\\\": \\\"ses tanÄ±mÄ± maksimum 15 kelime\\\",\\n  \\\"duration\\\": 30,\\n  \\\"style\\\": \\\"cinematic, ASMR, satisfying\\\"\\n}\",\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"Konu: {{$json.topic}}\\n\\nBu konu iÃ§in viral bir video fikri Ã¼ret. SADECE JSON dÃ¶ndÃ¼r.\"\n    }\n  ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [680, 400],
      "id": "claude-idea",
      "name": "ğŸ¤– Claude: Fikir Ãœret"
    },
    {
      "parameters": {
        "jsCode": "// Claude API yanÄ±tÄ±nÄ± parse et\nconst response = $json;\nconst topic = $('ğŸ“ Video Konusu').first().json.topic;\n\nconsole.log('ğŸ¨ Claude API Response:', JSON.stringify(response, null, 2));\n\nif (!response.content || !response.content[0] || !response.content[0].text) {\n  throw new Error('âŒ Claude API yanÄ±t vermedi: ' + JSON.stringify(response));\n}\n\nconst claudeText = response.content[0].text;\nconsole.log('ğŸ“ Claude yanÄ±tÄ±:', claudeText);\n\n// JSON'u Ã§Ä±kar\nlet parsed;\ntry {\n  // JSON'u bul\n  const jsonMatch = claudeText.match(/\\{[\\s\\S]*\\}/);\n  if (jsonMatch) {\n    parsed = JSON.parse(jsonMatch[0]);\n  } else {\n    throw new Error('JSON bulunamadÄ±');\n  }\n} catch (e) {\n  console.error('âŒ Parse hatasÄ±:', e);\n  console.error('Claude yanÄ±tÄ±:', claudeText);\n  throw new Error('Claude geÃ§erli JSON dÃ¶ndÃ¼rmedi. YanÄ±t: ' + claudeText.substring(0, 200));\n}\n\nif (!parsed.idea || !parsed.caption) {\n  throw new Error('âŒ Gerekli alanlar eksik: ' + JSON.stringify(parsed));\n}\n\nconsole.log('âœ… Fikir Ã¼retildi:', parsed.idea);\n\nreturn [{\n  json: {\n    ...parsed,\n    topic: topic\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [900, 400],
      "id": "parse-idea",
      "name": "ğŸ“‹ Parse Fikir"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.anthropic.com/v1/messages",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "anthropicApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "x-api-key",
              "value": "={{$env.ANTHROPIC_API_KEY}}"
            },
            {
              "name": "anthropic-version",
              "value": "2023-06-01"
            },
            {
              "name": "content-type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"claude-sonnet-4-20250514\",\n  \"max_tokens\": 4096,\n  \"temperature\": 0.8,\n  \"system\": \"Sen AI video generation iÃ§in detaylÄ± prompt yazan bir uzmansÄ±n (Gemini Veo 3 iÃ§in).\\n\\n**GÃ¶revin:**\\nVerilen video fikrine gÃ¶re, Veo 3'Ã¼n kullanabileceÄŸi detaylÄ± sinematik sahne tanÄ±mlarÄ± yaz.\\n\\n**Gereksinimler:**\\n1. Video sÃ¼resine gÃ¶re 1-3 sahne oluÅŸtur (15s video = 1 sahne, 30s = 2 sahne, 60s = 3 sahne)\\n2. Her sahne 800-1500 karakter olmalÄ±\\n3. Sinematik dil kullan (kamera aÃ§Ä±larÄ±, Ä±ÅŸÄ±k, hareket, renkler)\\n4. Ne GÃ–RÃœLEBÄ°LECEÄÄ°NE odaklan\\n5. ASMR dostu ve tatmin edici\\n\\n**SADECE bu JSON formatÄ±nÄ± dÃ¶ndÃ¼r:**\\n{\\n  \\\"scenes\\\": [\\n    {\\n      \\\"sceneNumber\\\": 1,\\n      \\\"duration\\\": 15,\\n      \\\"prompt\\\": \\\"DetaylÄ± gÃ¶rsel tanÄ±m (800-1500 karakter). Ã–rnek: Keskin bir bÄ±Ã§ak parlak mor sabun barÄ±nÄ± keserken macro Ã§ekim, kamera yavaÅŸÃ§a saÄŸa pan yapÄ±yor, yumuÅŸak stÃ¼dyo Ä±ÅŸÄ±ÄŸÄ± sabunun ipeksi yÃ¼zeyini parlat Ä±yor, bÄ±Ã§ak yavaÅŸ ve akÄ±cÄ± hareketle sabunu ikiye ayÄ±rÄ±yor, kesilen yÃ¼zeylerin pÃ¼rÃ¼zsÃ¼z dokusu gÃ¶rÃ¼lÃ¼yor, arka planda bulanÄ±k renkli sabunlar, 4K Ã§Ã¶zÃ¼nÃ¼rlÃ¼k, sinematik depth of field...\\\"\\n    }\\n  ],\\n  \\\"overallStyle\\\": \\\"cinematic, 4K, ASMR, satisfying, macro photography\\\",\\n  \\\"cameraWork\\\": \\\"smooth slow motion, close-ups, macro shots, gentle pan\\\",\\n  \\\"lighting\\\": \\\"soft studio light, natural daylight, highlights on textures\\\",\\n  \\\"colorPalette\\\": \\\"vibrant saturated colors, pastel tones\\\"\\n}\",\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"**Video Fikri:**\\n{{$json.idea}}\\n\\n**Konu:** {{$json.topic}}\\n**Ortam:** {{$json.environment}}\\n**Ses:** {{$json.sound}}\\n**Stil:** {{$json.style}}\\n**SÃ¼re:** {{$json.duration}} saniye\\n\\nBu fikir iÃ§in Veo 3'e verilecek detaylÄ± sahne promptlarÄ± Ã¼ret. SADECE JSON dÃ¶ndÃ¼r.\"\n    }\n  ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1120, 400],
      "id": "claude-prompts",
      "name": "ğŸ¬ Claude: Sahne PromptlarÄ±"
    },
    {
      "parameters": {
        "jsCode": "// Claude API yanÄ±tÄ±nÄ± parse et\nconst response = $json;\nconst ideaData = $('ğŸ“‹ Parse Fikir').first().json;\n\nconsole.log('ğŸ¬ Claude API Response:', JSON.stringify(response, null, 2));\n\nif (!response.content || !response.content[0] || !response.content[0].text) {\n  throw new Error('âŒ Claude API yanÄ±t vermedi');\n}\n\nconst claudeText = response.content[0].text;\nconsole.log('ğŸ“ Claude yanÄ±tÄ±:', claudeText);\n\nlet parsed;\ntry {\n  const jsonMatch = claudeText.match(/\\{[\\s\\S]*\\}/);\n  if (jsonMatch) {\n    parsed = JSON.parse(jsonMatch[0]);\n  } else {\n    throw new Error('JSON bulunamadÄ±');\n  }\n} catch (e) {\n  console.error('âŒ Parse hatasÄ±:', e);\n  throw new Error('Claude geÃ§erli JSON dÃ¶ndÃ¼rmedi: ' + claudeText.substring(0, 200));\n}\n\nif (!parsed.scenes || parsed.scenes.length === 0) {\n  throw new Error('âŒ Sahne bulunamadÄ±');\n}\n\nconsole.log('âœ…', parsed.scenes.length, 'sahne oluÅŸturuldu');\n\n// TÃ¼m sahne promptlarÄ±nÄ± birleÅŸtir Veo 3 iÃ§in\nconst combinedPrompt = parsed.scenes\n  .map((scene, i) => {\n    return scene.prompt;\n  })\n  .join(' ');\n\n// Ä°lk sahnenin promptunu al (Veo 3 tek prompt alÄ±yor)\nconst mainPrompt = parsed.scenes[0].prompt;\n\nreturn [{\n  json: {\n    ...ideaData,\n    scenes: parsed.scenes,\n    overallStyle: parsed.overallStyle,\n    cameraWork: parsed.cameraWork,\n    lighting: parsed.lighting,\n    colorPalette: parsed.colorPalette,\n    veo3Prompt: mainPrompt, // Veo 3 iÃ§in tek prompt\n    veo3FullPrompt: combinedPrompt, // TÃ¼m sahneler birleÅŸik\n    totalScenes: parsed.scenes.length\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1340, 400],
      "id": "parse-prompts",
      "name": "ğŸ“‹ Parse Promptlar"
    },
    {
      "parameters": {
        "resource": "message",
        "operation": "sendMessage",
        "chatId": "={{$env.TELEGRAM_CHAT_ID}}",
        "text": "=âœ… **AI VIDEO FÄ°KRÄ° HAZIR!**\n\nğŸ“Œ **Konu:** {{$json.topic}}\n\nğŸ’¡ **Fikir:** {{$json.idea}}\n\nğŸ“ **Caption:** {{$json.caption}}\n\nğŸ·ï¸ **Hashtags:**\n{{$json.hashtags.map(h => '#' + h).join(' ')}}\n\nğŸ¨ **Stil:** {{$json.style}}\nâ±ï¸ **SÃ¼re:** {{$json.duration}} saniye\nğŸï¸ **Sahne:** {{$json.totalScenes}}\n\nğŸ“¸ **Kamera:** {{$json.cameraWork}}\nğŸ’¡ **IÅŸÄ±k:** {{$json.lighting}}\nğŸ¨ **Renk:** {{$json.colorPalette}}\n\n---\n**ğŸ¬ VEO 3 PROMPTU:**\n\n{{$json.veo3Prompt.substring(0, 800)}}...\n\n_(Toplam {{$json.veo3Prompt.length}} karakter)_\n\nâ³ Åimdi Veo 3 ile video Ã¼retiliyor...",
        "options": {
          "parse_mode": "Markdown"
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [1560, 400],
      "id": "telegram-preview",
      "name": "ğŸ“± Telegram: Fikir Ã–zeti",
      "credentials": {
        "telegramApi": {
          "id": "TELEGRAM_CREDENTIAL_ID",
          "name": "Telegram Bot"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/veo-3:generateContent",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpQueryAuth",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "key",
              "value": "={{process.env.GOOGLE_AI_STUDIO || process.env.GEMINI_API_KEY}}"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [{\n    \"parts\": [{\n      \"text\": {{JSON.stringify($json.veo3Prompt)}}\n    }]\n  }],\n  \"generationConfig\": {\n    \"temperature\": 0.9,\n    \"maxOutputTokens\": 2048\n  }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1780, 400],
      "id": "veo3-generate",
      "name": "ğŸ¥ Veo 3: Video Ãœret"
    },
    {
      "parameters": {
        "jsCode": "// Veo 3 yanÄ±tÄ±nÄ± iÅŸle\nconst veoResponse = $json;\nconst metadata = $('ğŸ“‹ Parse Promptlar').first().json;\n\nconsole.log('ğŸ¬ Veo 3 Response:', JSON.stringify(veoResponse, null, 2));\n\n// Veo 3 farklÄ± response formatlarÄ± olabilir\nif (veoResponse.candidates && veoResponse.candidates[0]) {\n  // Gemini API text response\n  const candidate = veoResponse.candidates[0];\n  \n  if (candidate.content && candidate.content.parts && candidate.content.parts[0]) {\n    const result = candidate.content.parts[0];\n    \n    // Video URL var mÄ±?\n    if (result.videoUrl || result.video) {\n      return [{\n        json: {\n          ...metadata,\n          videoUrl: result.videoUrl || result.video,\n          status: 'completed',\n          message: 'âœ… Video baÅŸarÄ±yla oluÅŸturuldu!'\n        }\n      }];\n    }\n    \n    // Sadece text response (operation name olabilir)\n    if (result.text) {\n      return [{\n        json: {\n          ...metadata,\n          veo3Response: result.text,\n          status: 'processing',\n          message: 'â³ Video oluÅŸturuluyor... Response: ' + result.text.substring(0, 200)\n        }\n      }];\n    }\n  }\n}\n\n// Operation name formatÄ±\nif (veoResponse.name && veoResponse.name.includes('operations/')) {\n  return [{\n    json: {\n      ...metadata,\n      veo3Operation: veoResponse.name,\n      status: 'generating',\n      message: 'â³ Video Ã¼retimi baÅŸladÄ±. Operation: ' + veoResponse.name\n    }\n  }];\n}\n\n// Error kontrolÃ¼\nif (veoResponse.error) {\n  throw new Error('âŒ Veo 3 HatasÄ±: ' + JSON.stringify(veoResponse.error));\n}\n\n// Beklenmeyen format\nconsole.error('âš ï¸ Beklenmeyen Veo 3 response:', veoResponse);\nreturn [{\n  json: {\n    ...metadata,\n    veo3Response: veoResponse,\n    status: 'unknown',\n    message: 'âš ï¸ Veo 3 beklenmeyen yanÄ±t dÃ¶ndÃ¼rdÃ¼. Response loglarÄ± kontrol edin.'\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2000, 400],
      "id": "handle-veo3",
      "name": "ğŸ“Š Veo 3 YanÄ±t Ä°ÅŸle"
    },
    {
      "parameters": {
        "resource": "message",
        "operation": "sendMessage",
        "chatId": "={{$env.TELEGRAM_CHAT_ID}}",
        "text": "=ğŸ¬ **VEO 3 DURUM**\n\n{{$json.message}}\n\nğŸ“Œ **Fikir:** {{$json.idea}}\nâ±ï¸ **SÃ¼re:** {{$json.duration}}s\n\n{{$json.status === 'completed' ? 'âœ… **Video URL:** ' + $json.videoUrl : ''}}\n{{$json.status === 'generating' ? 'â³ **Operation:** ' + $json.veo3Operation : ''}}\n{{$json.status === 'processing' ? 'â³ Ä°ÅŸleniyor...' : ''}}\n{{$json.status === 'unknown' ? 'âš ï¸ LoglarÄ± kontrol et!' : ''}}\n\n---\nâ„¹ï¸ Video Ã¼retimi 2-5 dakika sÃ¼rebilir.\nOperation name aldÄ±ysan Google AI Studio'da kontrol edebilirsin.",
        "options": {
          "parse_mode": "Markdown"
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [2220, 400],
      "id": "telegram-veo3-status",
      "name": "ğŸ“± Telegram: Veo 3 Durum",
      "credentials": {
        "telegramApi": {
          "id": "TELEGRAM_CREDENTIAL_ID",
          "name": "Telegram Bot"
        }
      }
    }
  ],
  "connections": {
    "â–¶ï¸ Manuel BaÅŸlat": {
      "main": [
        [
          {
            "node": "ğŸ“ Video Konusu",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“ Video Konusu": {
      "main": [
        [
          {
            "node": "ğŸ¤– Claude: Fikir Ãœret",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ¤– Claude: Fikir Ãœret": {
      "main": [
        [
          {
            "node": "ğŸ“‹ Parse Fikir",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“‹ Parse Fikir": {
      "main": [
        [
          {
            "node": "ğŸ¬ Claude: Sahne PromptlarÄ±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ¬ Claude: Sahne PromptlarÄ±": {
      "main": [
        [
          {
            "node": "ğŸ“‹ Parse Promptlar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“‹ Parse Promptlar": {
      "main": [
        [
          {
            "node": "ğŸ“± Telegram: Fikir Ã–zeti",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“± Telegram: Fikir Ã–zeti": {
      "main": [
        [
          {
            "node": "ğŸ¥ Veo 3: Video Ãœret",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ¥ Veo 3: Video Ãœret": {
      "main": [
        [
          {
            "node": "ğŸ“Š Veo 3 YanÄ±t Ä°ÅŸle",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“Š Veo 3 YanÄ±t Ä°ÅŸle": {
      "main": [
        [
          {
            "node": "ğŸ“± Telegram: Veo 3 Durum",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "active": false
}
