{
  "name": "√úRETƒ∞M HATTI",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "tools/create_n8n_flow",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        240,
        300
      ],
      "id": "webhook-create-flow",
      "name": "TOOL_create_n8n_flow",
      "webhookId": "b145b66e-4470-419c-a0a2-83b4aa5c206d"
    },
    {
      "parameters": {
        "jsCode": "const req = $input.first().json;\nconst body = req.body || {};\nconst desc = (body.description || 'A√ßƒ±klama yok').toLowerCase();\nconst name = body.workflowName || 'ARGUS auto: ' + desc.slice(0, 30);\n\n// === YARDIMCI FONKSƒ∞YONLAR ===\nfunction generateId() {\n  return Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);\n}\n\nfunction getTypeVersion(type) {\n  const versions = {\n    'n8n-nodes-base.httpRequest': 4.3,\n    'n8n-nodes-base.code': 2,\n    'n8n-nodes-base.set': 3.4,\n    'n8n-nodes-base.splitOut': 1,\n    'n8n-nodes-base.sort': 1,\n    'n8n-nodes-base.limit': 1,\n    'n8n-nodes-base.manualTrigger': 1,\n    'n8n-nodes-base.scheduleTrigger': 1.3,\n    'n8n-nodes-base.gmail': 2.1,\n    'n8n-nodes-base.gmailTrigger': 1.3\n  };\n  return versions[type] || 1;\n}\n\nfunction createNode(type, nodeName, position, parameters, extras = {}) {\n  const node = {\n    parameters,\n    type,\n    typeVersion: getTypeVersion(type),\n    position,\n    id: extras.id || generateId(),\n    name: nodeName\n  };\n  if (extras.credentials) node.credentials = extras.credentials;\n  if (extras.webhookId) node.webhookId = extras.webhookId;\n  return node;\n}\n\nfunction addConnection(connections, fromNode, toNode) {\n  if (!connections[fromNode]) {\n    connections[fromNode] = { main: [[]] };\n  }\n  connections[fromNode].main[0].push({ node: toNode, type: 'main', index: 0 });\n}\n\n// === PATTERN DETEKSƒ∞YONU ===\nconst isScheduled = /her (g√ºn|saat|dakika|hafta)|g√ºnl√ºk|saatlik|zamanlanmƒ±≈ü|cron|\\d{1,2}:\\d{2}/i.test(desc);\nconst isCrypto = /bitcoin|btc|eth|ethereum|kripto|coin|fiyat.*kontrol|price.*check/i.test(desc);\nconst isTelegram = /telegram|mesaj g√∂nder|bildirim|notify/i.test(desc);\nconst isTwilio = /ara|arama|twilio|telefon|sesli|call/i.test(desc);\nconst isYouTube = /youtube|video.*trend|pop√ºler.*video|trending.*video/i.test(desc);\nconst isInstagram = /instagram|reel|story|post.*idea/i.test(desc);\nconst isGmail = /mail|e-posta|gmail|inbox/i.test(desc);\nconst needsAI = /ai|yapay zeka|claude|gpt|√∂ner|√ºret|analyze|benzer|similar/i.test(desc);\n\nlet nodes = [];\nlet connections = {};\nlet currentX = 240;\nconst Y = 300;\nconst SPACING = 220;\n\n// === TRIGGER NODE ===\nlet triggerNode;\nif (isGmail && !isScheduled) {\n  triggerNode = createNode('n8n-nodes-base.gmailTrigger', 'Gmail Trigger', [currentX, Y], {\n    pollTimes: { item: [{ mode: 'everyMinute' }] },\n    filters: {}\n  }, { credentials: { gmailOAuth2: { id: '4m3aMGjLm89egLIv', name: 'Gmail account 2' } } });\n} else if (isScheduled) {\n  let cronExpression = '0 9 * * *';\n  const hourMatch = desc.match(/(\\d{1,2}):(\\d{2})/);\n  if (hourMatch) {\n    cronExpression = `${hourMatch[2]} ${hourMatch[1]} * * *`;\n  } else if (/her saat/i.test(desc)) {\n    cronExpression = '0 * * * *';\n  } else if (/her (\\d+) dakika/i.test(desc)) {\n    const minutes = desc.match(/her (\\d+) dakika/i)[1];\n    cronExpression = `*/${minutes} * * * *`;\n  }\n  triggerNode = createNode('n8n-nodes-base.scheduleTrigger', 'Schedule Trigger', [currentX, Y], {\n    rule: { interval: [{ field: 'cronExpression', expression: cronExpression }] }\n  });\n} else {\n  triggerNode = createNode('n8n-nodes-base.manualTrigger', \"When clicking 'Execute workflow'\", [currentX, Y], {});\n}\n\nnodes.push(triggerNode);\nlet previousNodeName = triggerNode.name;\ncurrentX += SPACING;\n\n// === YOUTUBE WORKFLOW (YOU TUBE.json pattern) ===\nif (isYouTube) {\n  // 1. YouTube API Call - DOƒûRU endpoint: /videos?chart=mostPopular\n  const youtubeNode = createNode('n8n-nodes-base.httpRequest', 'YouTube API - Pop√ºler Videolar', [currentX, Y], {\n    method: 'GET',\n    url: 'https://www.googleapis.com/youtube/v3/videos',\n    sendQuery: true,\n    queryParameters: {\n      parameters: [\n        { name: 'chart', value: 'mostPopular' },\n        { name: 'regionCode', value: 'TR' },\n        { name: 'maxResults', value: '20' },\n        { name: 'part', value: 'snippet,statistics' },\n        { name: 'key', value: '={{$env.YOUTUBE_API_KEY}}' }\n      ]\n    },\n    options: { response: { response: { responseFormat: 'json' } } }\n  });\n  nodes.push(youtubeNode);\n  addConnection(connections, previousNodeName, youtubeNode.name);\n  previousNodeName = youtubeNode.name;\n  currentX += SPACING;\n\n  // 2. Split Out - Array'i ayrƒ± item'lara b√∂l\n  const splitNode = createNode('n8n-nodes-base.splitOut', 'Split Video Items', [currentX, Y], {\n    fieldName: 'items'\n  });\n  nodes.push(splitNode);\n  addConnection(connections, previousNodeName, splitNode.name);\n  previousNodeName = splitNode.name;\n  currentX += SPACING;\n\n  // 3. Set - Field mapping\n  const setNode = createNode('n8n-nodes-base.set', 'Video Verilerini D√ºzenle', [currentX, Y], {\n    assignments: {\n      assignments: [\n        { id: generateId(), name: 'title', value: '={{$json.snippet.title}}', type: 'string' },\n        { id: generateId(), name: 'channel', value: '={{$json.snippet.channelTitle}}', type: 'string' },\n        { id: generateId(), name: 'description', value: '={{$json.snippet.description}}', type: 'string' },\n        { id: generateId(), name: 'viewCount', value: '={{Number($json.statistics.viewCount) || 0}}', type: 'number' },\n        { id: generateId(), name: 'likeCount', value: '={{Number($json.statistics.likeCount) || 0}}', type: 'number' },\n        { id: generateId(), name: 'commentCount', value: '={{Number($json.statistics.commentCount) || 0}}', type: 'number' },\n        { id: generateId(), name: 'videoId', value: '={{$json.id}}', type: 'string' }\n      ]\n    },\n    options: {}\n  });\n  nodes.push(setNode);\n  addConnection(connections, previousNodeName, setNode.name);\n  previousNodeName = setNode.name;\n  currentX += SPACING;\n\n  // 4. Code - Scoring (YOU TUBE.json pattern)\n  const scoreNode = createNode('n8n-nodes-base.code', 'Skor Hesapla', [currentX, Y], {\n    jsCode: `const views = $json.viewCount || 0;\nconst likes = $json.likeCount || 0;\nconst comments = $json.commentCount || 0;\n\nconst engagementRate = views > 0 ? ((likes + comments) / views) * 100 : 0;\nconst score = (views * 0.5) + (likes * 30) + (comments * 50) + (engagementRate * 1000);\n\nreturn [{\n  json: {\n    ...$json,\n    engagementRate: engagementRate.toFixed(2),\n    score: Math.round(score)\n  }\n}];`\n  });\n  nodes.push(scoreNode);\n  addConnection(connections, previousNodeName, scoreNode.name);\n  previousNodeName = scoreNode.name;\n  currentX += SPACING;\n\n  // 5. Sort - Skora g√∂re sƒ±rala\n  const sortNode = createNode('n8n-nodes-base.sort', 'Skora G√∂re Sƒ±rala', [currentX, Y], {\n    sortFieldsUi: {\n      sortField: [{\n        fieldName: 'score',\n        order: 'descending'\n      }]\n    }\n  });\n  nodes.push(sortNode);\n  addConnection(connections, previousNodeName, sortNode.name);\n  previousNodeName = sortNode.name;\n  currentX += SPACING;\n\n  // 6. Limit - ƒ∞lk 3 video\n  const limitNode = createNode('n8n-nodes-base.limit', 'ƒ∞lk 3 Video', [currentX, Y], {\n    maxItems: 3\n  });\n  nodes.push(limitNode);\n  addConnection(connections, previousNodeName, limitNode.name);\n  previousNodeName = limitNode.name;\n  currentX += SPACING;\n\n  // 7. AI Analysis (eƒüer isteniyorsa)\n  if (needsAI) {\n    const aiNode = createNode('n8n-nodes-base.httpRequest', 'Claude AI - Video Analizi', [currentX, Y], {\n      method: 'POST',\n      url: 'https://api.anthropic.com/v1/messages',\n      sendHeaders: true,\n      headerParameters: {\n        parameters: [\n          { name: 'x-api-key', value: '={{$env.ANTHROPIC_API_KEY}}' },\n          { name: 'anthropic-version', value: '2023-06-01' },\n          { name: 'Content-Type', value: 'application/json' }\n        ]\n      },\n      sendBody: true,\n      specifyBody: 'json',\n      jsonBody: `={{ JSON.stringify({\n  model: 'claude-sonnet-4-5-20250929',\n  max_tokens: 512,\n  messages: [{\n    role: 'user',\n    content: 'Video: ' + $json.title + '\\\\nKanal: ' + $json.channel + '\\\\nG√∂r√ºnt√ºlenme: ' + $json.viewCount + '\\\\n\\\\nBu videoya benzer 2 i√ßerik fikri √∂ner (kƒ±sa ba≈ülƒ±klar, T√ºrk√ße).'\n  }]\n}) }}`,\n      options: { response: { response: { responseFormat: 'json' } } }\n    });\n    nodes.push(aiNode);\n    addConnection(connections, previousNodeName, aiNode.name);\n    previousNodeName = aiNode.name;\n    currentX += SPACING;\n\n    // AI yanƒ±tƒ±nƒ± parse et\n    const parseAINode = createNode('n8n-nodes-base.code', 'AI Cevabƒ±nƒ± Formatla', [currentX, Y], {\n      jsCode: `const items = $input.all();\nlet message = 'üé¨ YouTube Trend Analizi\\\\n\\\\n';\n\nitems.forEach((item, i) => {\n  const title = item.json.title || '-';\n  const channel = item.json.channel || '-';\n  const score = item.json.score || 0;\n  const aiResponse = item.json.content?.[0]?.text || 'AI √∂nerisi yok';\n\n  message += \\`üìπ Video \\${i+1}: \\${title}\\\\n\\`;\n  message += \\`üë§ Kanal: \\${channel}\\\\n\\`;\n  message += \\`‚≠ê Skor: \\${score}\\\\n\\`;\n  message += \\`üí° AI √ñnerisi: \\${aiResponse}\\\\n\\\\n\\`;\n});\n\nreturn [{ json: { message } }];`\n    });\n    nodes.push(parseAINode);\n    addConnection(connections, previousNodeName, parseAINode.name);\n    previousNodeName = parseAINode.name;\n    currentX += SPACING;\n  } else {\n    // Basit formatla\n    const simpleFormatNode = createNode('n8n-nodes-base.code', 'Basit Format', [currentX, Y], {\n      jsCode: `const items = $input.all();\nlet message = 'üé¨ En Pop√ºler Videolar:\\\\n\\\\n';\n\nitems.forEach((item, i) => {\n  message += \\`\\${i+1}. \\${item.json.title}\\\\n\\`;\n  message += \\`   Kanal: \\${item.json.channel}\\\\n\\`;\n  message += \\`   G√∂r√ºnt√ºlenme: \\${item.json.viewCount}\\\\n\\\\n\\`;\n});\n\nreturn [{ json: { message } }];`\n    });\n    nodes.push(simpleFormatNode);\n    addConnection(connections, previousNodeName, simpleFormatNode.name);\n    previousNodeName = simpleFormatNode.name;\n    currentX += SPACING;\n  }\n}\n\n// === INSTAGRAM WORKFLOW ===\nelse if (isInstagram) {\n  // Instagram i√ßin yapay i√ßerik √ºretimi\n  const instaPrepNode = createNode('n8n-nodes-base.code', 'Instagram Reel Prompt Hazƒ±rla', [currentX, Y], {\n    jsCode: `const topic = '${desc}'.replace(/instagram|reel|hazƒ±rla|√ºret/gi, '').trim() || 'genel i√ßerik';\nreturn [{ json: { topic, prompt: \\`\\${topic} konusunda viral olabilecek 3 Instagram Reel fikri √∂ner. Her biri i√ßin: ba≈ülƒ±k, a√ßƒ±klama, hashtag'ler.\\` } }];`\n  });\n  nodes.push(instaPrepNode);\n  addConnection(connections, previousNodeName, instaPrepNode.name);\n  previousNodeName = instaPrepNode.name;\n  currentX += SPACING;\n\n  const aiNode = createNode('n8n-nodes-base.httpRequest', 'Claude AI - Reel Fikirleri', [currentX, Y], {\n    method: 'POST',\n    url: 'https://api.anthropic.com/v1/messages',\n    sendHeaders: true,\n    headerParameters: {\n      parameters: [\n        { name: 'x-api-key', value: '={{$env.ANTHROPIC_API_KEY}}' },\n        { name: 'anthropic-version', value: '2023-06-01' },\n        { name: 'Content-Type', value: 'application/json' }\n      ]\n    },\n    sendBody: true,\n    specifyBody: 'json',\n    jsonBody: `={{ JSON.stringify({ model: 'claude-sonnet-4-5-20250929', max_tokens: 1024, messages: [{ role: 'user', content: $json.prompt }] }) }}`,\n    options: { response: { response: { responseFormat: 'json' } } }\n  });\n  nodes.push(aiNode);\n  addConnection(connections, previousNodeName, aiNode.name);\n  previousNodeName = aiNode.name;\n  currentX += SPACING;\n\n  const formatNode = createNode('n8n-nodes-base.code', 'Format AI Response', [currentX, Y], {\n    jsCode: `const aiText = $json.content?.[0]?.text || '√ñneri √ºretilemedi';\nreturn [{ json: { message: 'üì∏ Instagram Reel Fikirleri:\\\\n\\\\n' + aiText } }];`\n  });\n  nodes.push(formatNode);\n  addConnection(connections, previousNodeName, formatNode.name);\n  previousNodeName = formatNode.name;\n  currentX += SPACING;\n}\n\n// === GMAIL WORKFLOW (Derinsu.json pattern) ===\nelse if (isGmail) {\n  // Gmail trigger zaten yukarƒ±da eklendi\n  const getMessageNode = createNode('n8n-nodes-base.gmail', 'Get Email Details', [currentX, Y], {\n    operation: 'get',\n    messageId: '={{ $json.id }}',\n    simple: false,\n    options: {}\n  }, { credentials: { gmailOAuth2: { id: '4m3aMGjLm89egLIv', name: 'Gmail account 2' } } });\n  nodes.push(getMessageNode);\n  addConnection(connections, previousNodeName, getMessageNode.name);\n  previousNodeName = getMessageNode.name;\n  currentX += SPACING;\n\n  if (needsAI) {\n    // AI ile email √∂zetleme\n    const aiNode = createNode('n8n-nodes-base.httpRequest', 'Claude AI - Email √ñzeti', [currentX, Y], {\n      method: 'POST',\n      url: 'https://api.anthropic.com/v1/messages',\n      sendHeaders: true,\n      headerParameters: {\n        parameters: [\n          { name: 'x-api-key', value: '={{$env.ANTHROPIC_API_KEY}}' },\n          { name: 'anthropic-version', value: '2023-06-01' },\n          { name: 'Content-Type', value: 'application/json' }\n        ]\n      },\n      sendBody: true,\n      specifyBody: 'json',\n      jsonBody: `={{ JSON.stringify({\n  model: 'claude-sonnet-4-5-20250929',\n  max_tokens: 512,\n  messages: [{\n    role: 'user',\n    content: 'Konu: ' + $json.subject + '\\\\nKimden: ' + ($json.from?.value?.[0]?.address || '-') + '\\\\nƒ∞√ßerik: ' + ($json.textPlain || $json.snippet || '-') + '\\\\n\\\\nBu e-postayƒ± √∂zetle (1-2 c√ºmle, T√ºrk√ße).'\n  }]\n}) }}`,\n      options: { response: { response: { responseFormat: 'json' } } }\n    });\n    nodes.push(aiNode);\n    addConnection(connections, previousNodeName, aiNode.name);\n    previousNodeName = aiNode.name;\n    currentX += SPACING;\n\n    const formatNode = createNode('n8n-nodes-base.code', 'Format Email Summary', [currentX, Y], {\n      jsCode: `const subject = $('Get Email Details').item.json.subject || '-';\nconst from = $('Get Email Details').item.json.from?.value?.[0]?.address || '-';\nconst summary = $json.content?.[0]?.text || '√ñzet olu≈üturulamadƒ±';\nconst message = 'üìß Yeni Email:\\\\nüë§ Kimden: ' + from + '\\\\nüß∑ Konu: ' + subject + '\\\\nüìù √ñzet: ' + summary;\nreturn [{ json: { message } }];`\n    });\n    nodes.push(formatNode);\n    addConnection(connections, previousNodeName, formatNode.name);\n    previousNodeName = formatNode.name;\n    currentX += SPACING;\n  } else {\n    const simpleFormatNode = createNode('n8n-nodes-base.code', 'Simple Email Format', [currentX, Y], {\n      jsCode: `const subject = $json.subject || '-';\nconst from = $json.from?.value?.[0]?.address || '-';\nconst message = 'üìß Yeni Email:\\\\nüë§ Kimden: ' + from + '\\\\nüß∑ Konu: ' + subject;\nreturn [{ json: { message } }];`\n    });\n    nodes.push(simpleFormatNode);\n    addConnection(connections, previousNodeName, simpleFormatNode.name);\n    previousNodeName = simpleFormatNode.name;\n    currentX += SPACING;\n  }\n}\n\n// === CRYPTO WORKFLOW ===\nelse if (isCrypto) {\n  const cryptoId = /bitcoin|btc/i.test(desc) ? 'bitcoin' : 'ethereum';\n  const cryptoName = cryptoId === 'bitcoin' ? 'BTC' : 'ETH';\n\n  const fetchNode = createNode('n8n-nodes-base.httpRequest', 'Fetch Crypto Price', [currentX, Y], {\n    method: 'GET',\n    url: `https://api.coingecko.com/api/v3/simple/price?ids=${cryptoId}&vs_currencies=try`,\n    options: { response: { response: { responseFormat: 'json' } } }\n  });\n  nodes.push(fetchNode);\n  addConnection(connections, previousNodeName, fetchNode.name);\n  previousNodeName = fetchNode.name;\n  currentX += SPACING;\n\n  const processNode = createNode('n8n-nodes-base.code', 'Process Crypto Data', [currentX, Y], {\n    jsCode: `const data = $json;\nconst cryptoName = Object.keys(data)[0];\nconst price = data[cryptoName].try;\nconst message = 'üí∞ ' + cryptoName.toUpperCase() + ' fiyatƒ±: ' + Number(price).toLocaleString('tr-TR') + ' TL';\nreturn [{ json: { message, price, cryptoName } }];`\n  });\n  nodes.push(processNode);\n  addConnection(connections, previousNodeName, processNode.name);\n  previousNodeName = processNode.name;\n  currentX += SPACING;\n}\n\n// === GENERIC AI REQUEST ===\nelse if (needsAI && !isYouTube && !isInstagram && !isGmail) {\n  const aiNode = createNode('n8n-nodes-base.httpRequest', 'Claude AI - Generic', [currentX, Y], {\n    method: 'POST',\n    url: 'https://api.anthropic.com/v1/messages',\n    sendHeaders: true,\n    headerParameters: {\n      parameters: [\n        { name: 'x-api-key', value: '={{$env.ANTHROPIC_API_KEY}}' },\n        { name: 'anthropic-version', value: '2023-06-01' },\n        { name: 'Content-Type', value: 'application/json' }\n      ]\n    },\n    sendBody: true,\n    specifyBody: 'json',\n    jsonBody: `={{ JSON.stringify({ model: 'claude-sonnet-4-5-20250929', max_tokens: 1024, messages: [{ role: 'user', content: '${desc}' }] }) }}`,\n    options: { response: { response: { responseFormat: 'json' } } }\n  });\n  nodes.push(aiNode);\n  addConnection(connections, previousNodeName, aiNode.name);\n  previousNodeName = aiNode.name;\n  currentX += SPACING;\n\n  const formatNode = createNode('n8n-nodes-base.code', 'Format AI Response', [currentX, Y], {\n    jsCode: `const aiText = $json.content?.[0]?.text || 'Cevap alƒ±namadƒ±';\nreturn [{ json: { message: aiText } }];`\n  });\n  nodes.push(formatNode);\n  addConnection(connections, previousNodeName, formatNode.name);\n  previousNodeName = formatNode.name;\n  currentX += SPACING;\n}\n\n// === TWILIO CALL (TWILIO ARAMA.json pattern) ===\nif (isTwilio) {\n  const twilioDataNode = createNode('n8n-nodes-base.code', 'Twilio Data Hazƒ±rla', [currentX, Y], {\n    jsCode: `const to = process.env.ALERT_TARGET_NUMBER || '+905454423820';\nconst from = process.env.TWILIO_PHONE_NUMBER || '+127223344653';\nconst messageText = $json.message || 'Bildirim';\nconst webhookUrl = 'https://argusbot.duckdns.org/webhook/argus_voice_agent';\n\nconst twiml = \\`\n<Response>\n  <Gather input=\"speech\" language=\"tr-TR\" method=\"POST\" action=\"\\${webhookUrl}\">\n    <Say language=\"tr-TR\">\\${messageText}</Say>\n  </Gather>\n</Response>\n\\`.trim();\n\nreturn [{ json: { to, from, twiml } }];`\n  });\n  nodes.push(twilioDataNode);\n  addConnection(connections, previousNodeName, twilioDataNode.name);\n  previousNodeName = twilioDataNode.name;\n  currentX += SPACING;\n\n  const twilioCallNode = createNode('n8n-nodes-base.httpRequest', 'Twilio Call', [currentX, Y], {\n    method: 'POST',\n    url: '=https://api.twilio.com/2010-04-01/Accounts/{{$env.TWILIO_ACCOUNT_SID}}/Calls.json',\n    authentication: 'genericCredentialType',\n    genericAuthType: 'httpBasicAuth',\n    sendBody: true,\n    contentType: 'raw',\n    rawContentType: '=application/x-www-form-urlencoded',\n    body: `={{ 'To=' + encodeURIComponent($json.to) + '&From=' + encodeURIComponent($json.from) + '&Twiml=' + encodeURIComponent($json.twiml) }}`,\n    options: {}\n  }, { credentials: { httpBasicAuth: { id: 'Tn2UknHXfLcUtpyN', name: 'Twilio Credentials' } } });\n  nodes.push(twilioCallNode);\n  addConnection(connections, previousNodeName, twilioCallNode.name);\n  previousNodeName = twilioCallNode.name;\n  currentX += SPACING;\n}\n\n// === TELEGRAM NOTIFICATION ===\nif (isTelegram) {\n  const telegramNode = createNode('n8n-nodes-base.httpRequest', 'Send Telegram Message', [currentX, Y], {\n    method: 'POST',\n    url: '=https://api.telegram.org/bot{{$env.TELEGRAM_BOT_TOKEN}}/sendMessage',\n    sendBody: true,\n    bodyParameters: {\n      parameters: [\n        { name: 'chat_id', value: '1496380263' },\n        { name: 'text', value: '={{$json.message || \"Bildirim\"}}' }\n      ]\n    },\n    options: {}\n  });\n  nodes.push(telegramNode);\n  addConnection(connections, previousNodeName, telegramNode.name);\n  previousNodeName = telegramNode.name;\n  currentX += SPACING;\n}\n\n// === FALLBACK: Basit i≈ülem ===\nif (nodes.length === 1) {\n  const placeholderNode = createNode('n8n-nodes-base.code', 'Process Data', [currentX, Y], {\n    jsCode: `return [{ json: { message: 'Workflow ba≈üarƒ±yla olu≈üturuldu!', description: '${desc}' } }];`\n  });\n  nodes.push(placeholderNode);\n  addConnection(connections, previousNodeName, placeholderNode.name);\n}\n\n// === WORKFLOW OLU≈ûTUR ===\nconst apiWorkflow = {\n  name,\n  nodes,\n  connections,\n  settings: { executionOrder: 'v1' }\n};\n\nreturn [{ json: { apiWorkflow } }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        460,
        300
      ],
      "id": "workflow-builder-main",
      "name": "WORKFLOW BUILDER"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://127.0.0.1:5678/api/v1/workflows",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "X-N8N-API-KEY",
              "value": "={{$env.N8N_API_KEY}}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify($json.apiWorkflow) }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        680,
        300
      ],
      "id": "n8n-api-create",
      "name": "n8n API - Create Workflow"
    },
    {
      "parameters": {
        "jsCode": "const item = $input.first().json;\nconst data = item.data || item;\n\nif (!data || !data.id) {\n  return [{ json: { ok: false, error: item.message || 'Workflow olu≈üturulamadƒ±', raw: item } }];\n}\n\nreturn [{ json: { ok: true, workflowId: data.id, name: data.name, reply: `‚úÖ Workflow olu≈üturuldu: ${data.name}\\nID: ${data.id}` } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        900,
        300
      ],
      "id": "response-builder",
      "name": "Response Builder"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {
          "responseCode": 200
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        1120,
        300
      ],
      "id": "webhook-response",
      "name": "Respond to Webhook"
    }
  ],
  "pinData": {},
  "connections": {
    "TOOL_create_n8n_flow": {
      "main": [
        [
          {
            "node": "WORKFLOW BUILDER",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "WORKFLOW BUILDER": {
      "main": [
        [
          {
            "node": "n8n API - Create Workflow",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "n8n API - Create Workflow": {
      "main": [
        [
          {
            "node": "Response Builder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Response Builder": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1",
    "timezone": "Europe/Istanbul",
    "callerPolicy": "workflowsFromSameOwner"
  },
  "versionId": "workflow-builder-v3-youtube",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "b3095fc29cb871b1a1fa62649bfd13016a8a983bdcd4a1523275b8f83ce36cce"
  },
  "id": "0OvLyVNV4rEQp2qz",
  "tags": []
}